### Act2 延迟执行的重启恢复方案

1. 任务进入延迟队列时保存队列信息到文件
2. 任务出延迟队列时删除文件



文件内容格式(json)：

```json
{
	"jobRecordId":"作业记录id",
	"jobRunTime":"作业预估的执行时间"
}
```



恢复逻辑

- master启动时扫描本地目录下所有的延迟队列文件
- 取出所有文件名对应的信息内容
- 取出所有文件名对应的作业列表
- 依据上述作业列表，查找数据库中对应的作业
- 判定数据库中作业的时间与记录时间的关系：
  - 当当前时间小于作业预估的执行时间，计算出新的延迟时间后重新放入延迟队列
  - 当当前时间等于或大于作业预估的执行时间但还未到超时时间的，删除文件、重新计算超时时间并立即执行
  - 当当前时间已经超时的，则删除文件并给第三方回调